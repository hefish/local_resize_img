<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title> test upload page </title>
</head>
<body>

<form action="upload.php" method="post">
file:  <input type="file" class="upload_file" id="upload_file_0" name="upload_file[]" /> <br />
            <label for="upload_file_0" class=" " >
                <img id="up_img_0" alt="aaa" width=50 height=50 />
            </label>
    	<input type="hidden" id="upload_file_data_0" name="upload_file_data[]" value="" />
    	<input type="hidden" id="upload_file_name_0" name="upload_file_name[]" value="" />

<input type="submit" id="submit_button" name="submit" value="上传" />

</form>


<script src="js/zepto.min.js" type="text/javascript"></script>
<script src="js/exif.js" type="text/javascript"></script>
<script src="js/jpegencoder.js" type="text/javascript"></script>
<script src="js/local_resize_img.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
        $(".upload_file").each(function(index, el) {
            console.log(this);
            $(this).html("<script type='text/javascript'>\
            	$('#upload_file_"+ index+"').local_resize_img({\
            		success: function (result) {\
            			$('#up_img_"+index+"').attr({src:result.base64});\
            			$('#upload_file_data_"+index+"').val(result.base64);\
            			$('#upload_file_"+index+"').val('');\
            	}}); <\/script>");
        });
    });
</script>

</body>
</html>